
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Develop for Relayer · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="PolyNetwork">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sharing-plus/all.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sharing-plus/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-flexible-linkcard/flexible-linkcard.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-flexible-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-okaidia.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-theme-hqbook/theme.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../launch_and_test/launch.html" />
    
    
    <link rel="prev" href="../side_chain/contracts.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="header-inner">
        <!-- LOGO -->
        <div class="logo">
            <img src="" alt="logo">
        </div>
        <span class="title"></span>

        <!-- Search -->
        
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>


        <!-- Nav -->
        <ul class="header-nav">
            <li>
                <a href="https://poly.network/" target="_blank">Home</a>
            </li><li>
                <a href="https://bridge.poly.network/" target="_blank">Poly Bridge</a>
            </li><li>
                <a href="https://explorer.poly.network/" target="_blank">Poly Explorer</a>
            </li>
        </ul>
    </div>

    <div class="book-summary">
        <!--<div class="book-summary-title">文档目录</div>-->
        
        
        <nav role="navigation">
            


<ul class="summary">
    
    

    

    
        
        <li class="header">Introduction</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    About Poly Network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../guideline.html">
            
                <a href="../../guideline.html">
            
                    
                    Guidelines for Reading
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Development</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../readme.html">
            
                <a href="../readme.html">
            
                    
                    Connect New Chains
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../relay_chain/relay_chain_development.html">
            
                <a href="../relay_chain/relay_chain_development.html">
            
                    
                    Develop for Relay Chain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../side_chain/contracts.html">
            
                <a href="../side_chain/contracts.html">
            
                    
                    Develop for Side Chain
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.1.3" data-path="relayer.html">
            
                <a href="relayer.html">
            
                    
                    Develop for Relayer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../launch_and_test/launch.html">
            
                <a href="../launch_and_test/launch.html">
            
                    
                    Launch and Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../new_product/integrate_bridge/readme.html">
            
                <a href="../../new_product/integrate_bridge/readme.html">
            
                    
                    Build New Bridges
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../../new_product/integrate_bridge/bridge.html">
            
                <a href="../../new_product/integrate_bridge/bridge.html">
            
                    
                    Guidelines for Developing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../../new_product/integrate_bridge/launch.html">
            
                <a href="../../new_product/integrate_bridge/launch.html">
            
                    
                    Launch and Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../new_product/integrate_tokens/readme.html">
            
                <a href="../../new_product/integrate_tokens/readme.html">
            
                    
                    Register New Tokens
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../../new_product/integrate_tokens/tokens.html">
            
                <a href="../../new_product/integrate_tokens/tokens.html">
            
                    
                    Tokens Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../../new_product/integrate_tokens/launch.html">
            
                <a href="../../new_product/integrate_tokens/launch.html">
            
                    
                    Launch and Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../new_product/integrate_contracts/readme.html">
            
                <a href="../../new_product/integrate_contracts/readme.html">
            
                    
                    Customize Business Logic Contracts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../../new_product/integrate_contracts/Customizing Business Logic Contract.html">
            
                <a href="../../new_product/integrate_contracts/Customizing Business Logic Contract.html">
            
                    
                    Guidelines for Developing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../../new_product/integrate_contracts/launch.html">
            
                <a href="../../new_product/integrate_contracts/launch.html">
            
                    
                    Launch and Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Appendix</li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <span>
            
                    
                    Core Smart Contract
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../../Core_Smart_Contract/">
            
                <a href="../../Core_Smart_Contract/">
            
                    
                    MainNet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../../Core_Smart_Contract/README_TestNet.html">
            
                <a href="../../Core_Smart_Contract/README_TestNet.html">
            
                    
                    TestNet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../../Core_Smart_Contract/README_DevNet.html">
            
                <a href="../../Core_Smart_Contract/README_DevNet.html">
            
                    
                    DevNet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../../Core_Smart_Contract/Zion_dev_contracts.html">
            
                <a href="../../Core_Smart_Contract/Zion_dev_contracts.html">
            
                    
                    Zion_DevNet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Glossary</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../GLOSSARY.html">
            
                <a href="../../GLOSSARY.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">FAQ</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../FAQ/template.html">
            
                <a href="../../FAQ/template.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


        </nav>
        
        
    </div>

    <!-- Content nav -->
    <div class="book-anchor">
        <!--<div class="book-anchor-title">在这篇文章中:</div>-->
        <div class="book-anchor-body">

        </div>
    </div>

    <div class="book-body">
        
        <div class="body-inner">
            
            

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Develop for Relayer</a>
    </h1>
</div>




            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                    
<div id="book-search-results">
    <div class="search-noresults">
    
                    <section class="normal markdown-section">
                        
                        <h1 align="center" id="develop-for-relayer">Develop for Relayer</h1>

<h2 id="development-specifications-for-relayer">Development Specifications for Relayer</h2>
<p>Poly <a href="../../GLOSSARY.html#relayer" class="glossary-term" title="A cross-chain information porter performs some of the most critical operations within the cross-chain. It acts as the medium of interaction between the side chain and the outside world.">relayer</a> plays the role to relay cross chains messages and interact with cross chain manager contracts. There are two components in the implementation:</p>
<div align="center"><a href="resources/develop_for_relayer.png" data-lightbox="1f0a25d4-ba98-4b4a-9724-4a8af6bad091" data-title=""><img src="resources/develop_for_relayer.png" alt=""></a></div>


<h3 id="step1-implement-chain-listener">Step1. Implement Chain Listener</h3>
<p>Chain listener is used to fetch data from the chain (as <a href="../../GLOSSARY.html#source-chain" class="glossary-term" title="A public chain corresponds to the target chain where a particular asset firstly appears.">source chain</a>), including block headers, cross chain events emitted from cross chain manager contract and merkle proofs when it&apos;s used to verify the cross chain message in the <code>Poly</code> chain.</p>
<pre class="language-"><code>type IChainListener interface {
  // Initialize with config
  Init(*config.ListenerConfig, *poly.SDK) error
  // Blocks to confirm
  Defer() int
  // New block check interval
  ListenCheck() time.Duration
  // Chain Id
  ChainId() uint64
  // Optional: Fetch block header and header hash, used to submit to poly chain for verifications
  Header(height uint64) (header []byte, hash []byte, err error)
  // Optional: Last header sync state in poly chain.
  LastHeaderSync(uint64, uint64) (uint64, error)
  // Scan cross chain transactions included in the block
  Scan(uint64) ([]*msg.Tx, error)
  // Compose cross chain message before submit to poly chain
  Compose(*msg.Tx) error
  // Current chain height
  LatestHeight() (uint64, error)
}
</code></pre><h3 id="step2-implement-chain-submitter">Step2. Implement Chain Submitter</h3>
<p>Chain submitter is used to submit messages/transactions to the chain, including  bookkeeper changes of the <a href="../../GLOSSARY.html#poly-chain" class="glossary-term" title="The Relay chain in the cross-chain ecosystem. One of the crucial components of the cross-chain ecosystem. Each type of node is deployed and maintained by other individuals or organizations and has its unique governance and trust mechanism. The relay chain is responsible for connecting them, standardizing cross-chain data flow and interfaces, verifying the legitimacy of cross-chain data, etc.">poly chain</a> and cross chain message to finalize as the last step.</p>
<pre class="language-"><code>type IChainSubmitter interface {
  // Initialize with config
  Init(*config.SubmitterConfig) error
  // Submit message/transaction to the chain
  Submit(msg.Message) error
  // Start the thread
  Start(context.Context, *sync.WaitGroup, bus.TxBus, bus.DelayedTxBus, msg.PolyComposer) error  
  // Process the cross chain message from poly chain
  ProcessTx(*msg.Tx, msg.PolyComposer) error
}
</code></pre><p>The <code>poly-relayer</code> project depends on the <code>bridge-common</code> library. Listed steps can be followed to register a new chain.</p>
<ul>
<li>Add chain ID in the <code>bridge-common</code> project.</li>
<li>Add chain client SDK here for common usage.</li>
<li>Add chain wallet SDK here for common usage.</li>
<li>Implement interface <code>IChainListener</code> and <code>IChainSubmitter</code> for the new chain.</li>
<li>Register <code>ChainListener</code> and <code>ChainSubmitter</code> in <a href="https://github.com/polynetwork/poly-relayer/blob/main/relayer/relayer.go#L73" target="_blank">selectors</a> located in the <code>relayer.go</code> file.</li>
</ul>
<h2 id="subcommands">Subcommands</h2>
<ul>
<li><code>settxblock</code> can set the scan initial height.</li>
<li><code>setheaderblock</code> can set the header sync height.</li>
<li><code>status</code> shows the current <a href="../../GLOSSARY.html#relayer" class="glossary-term" title="A cross-chain information porter performs some of the most critical operations within the cross-chain. It acts as the medium of interaction between the side chain and the outside world.">relayer</a> status.</li>
</ul>
<h2 id="other-notes">Other Notes</h2>
<ul>
<li>Please follow <a href="https://github.com/polynetwork/poly-relayer/tree/main/docs" target="_blank">here</a> for deployment guide.</li>
<li>Wallet balance should be checked regularly to avoid out of fee balance issue.</li>
<li>Mulitple wallet accounts can be created to increase message relay throughout.</li>
</ul>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; 2022 PolyNetwork. All right reserved.</span><span class="footer-modification">Last modification date&#xFF1A;
2022-02-08 14:55:46
</span></footer>
                        
                    </section>
                    
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                </div>
            </div>
            
        </div>

        
        
        <a href="../side_chain/contracts.html"
           class="navigation navigation-prev "
           aria-label="Previous page: Develop for Side Chain">
            <i class="fa fa-angle-left"></i>
        </a>
        
        
        <a href="../launch_and_test/launch.html"
           class="navigation navigation-next "
           aria-label="Next page: Launch and Testing">
            <i class="fa fa-angle-right"></i>
        </a>
        
        
        
    </div>
    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Develop for Relayer","level":"2.1.3","depth":2,"next":{"title":"Launch and Testing","level":"2.1.4","depth":2,"path":"new_chain/launch_and_test/launch.md","ref":"new_chain/launch_and_test/launch.md","articles":[]},"previous":{"title":"Develop for Side Chain","level":"2.1.2","depth":2,"path":"new_chain/side_chain/contracts.md","ref":"new_chain/side_chain/contracts.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","sharing-plus","theme-hqbook","flexible-linkcard","emphasize","flexible-alerts","lightbox","alerts","expandable-chapters","custom-favicon","tbfed-pagefooter","hide-element","-lunr","-search","search-pro","code","heading-anchors","-highlight","prism","prism-themes","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy 2022 PolyNetwork.","modify_label":"Last modification date：","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prismjs/themes/prism-okaidia.css"]},"emphasize":{},"livereload":{},"search-pro":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"flexible-linkcard":{"hrefUrl":"../../demo/demo.html","imgClass":"","imgSrc":"../../images/home/logo.png","target":"_blank","title":"Converts blockquotes into beautiful linkcard, custom nice links"},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"heading-anchors":{},"favicon":"resources/favicon.ico","lightbox":{"jquery":true,"sameUuid":false},"prism-themes":{},"theme-hqbook":{"copyButtons":false,"copyLines":true,"dragSplitter":true,"favicon":"./favicon.ico","flexible-linkcard":{"hrefUrl":"https://poly.network/#/","imgClass":"rect","imgSrc":"/resources/logo.png","target":"_blank","title":"flexible-linkcard"},"logo":"/resources/logo.png","search-placeholder":"Search...","hide-elements":[".summary .gitbook-link"]},"alerts":{},"custom-favicon":{},"flexible-alerts":{"danger":{"className":"danger","icon":"fa fa-ban","label":"Attention"},"note":{"className":"info","icon":"fa fa-info-circle","label":"Note"},"style":"callout","tip":{"className":"tip","icon":"fa fa-lightbulb-o","label":"Tip"},"warning":{"className":"warning","icon":"fa fa-exclamation-triangle","label":"Warning"}},"links":{"sidebar":{"Blog":"https://blog.csdn.net/ming_97y","Github":"https://github.com/jiangminggithub"}},"sharing":{"qq":false,"telegram":true,"youtube":true,"github":true,"douban":false,"facebook":false,"weibo":false,"discord":true,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"medium":true,"pocket":false,"google":false,"viber":false,"stumbleupon":false,"email":true,"qzone":false,"linkedin":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"theme":"default","author":"PolyNetwork","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"introduction.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"lightbox":{"includeJQuery":false,"sameUuid":true,"options":{"resizeDuration":500,"wrapAround":false}},"variables":{"themeHqbook":{"nav":[{"url":"https://poly.network/","target":"_blank","name":"Home"},{"url":"https://bridge.poly.network/","target":"_blank","name":"Poly Bridge"},{"url":"https://explorer.poly.network/","target":"_blank","name":"Poly Explorer"}]}},"title":"","flexible-alerts":{"style":"callout","comment":{"label":"Comment","icon":"fa fa-comments","className":"info"}},"gitbook":"*","theme-default":{"showLevel":true}},"file":{"path":"new_chain/relayer/relayer.md","mtime":"2022-02-08T06:55:46.749Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-02-08T07:16:39.545Z"},"basePath":"../..","book":{"language":""}})
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-flexible-linkcard/flexible-linkcard.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-flexible-alerts/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-alerts/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-theme-hqbook/theme.js"></script>
        
    

    </body>
</html>

